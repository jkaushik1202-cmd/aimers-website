<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
  <title>AIMERS — Always Ahead! 🎯</title>
  <meta name="description" content="AIMERS — Chill + Study + Win. Coaching with daily targets, attendance & assignments." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            maroon: '#800020',
            'maroon-light': '#a0002a',
            'maroon-dark': '#600018'
          }
        }
      }
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;900&display=swap');
    *{font-family:'Poppins',sans-serif}
    html,body{-webkit-text-size-adjust:100%;text-size-adjust:100%}
    input,select,textarea,button{font-size:16px !important} /* prevent mobile auto-zoom */
    .gradient-bg{background:linear-gradient(135deg,#800020 0%,#a0002a 100%)}
    .card-hover{transition:all .25s ease}
    .card-hover:hover{transform:translateY(-6px);box-shadow:0 20px 40px rgba(128,0,32,.18)}
    .float-in{animation:floatIn .6s ease both}
    @keyframes floatIn{0%{opacity:0;transform:translateY(12px) scale(.98)}100%{opacity:1;transform:translateY(0) scale(1)}}
    .aim-shadow{box-shadow:0 12px 28px rgba(0,0,0,.16)}
    .typing-dot{width:6px;height:6px;border-radius:9999px;background:#9ca3af;display:inline-block;margin:0 2px;animation:bounce 1s infinite}
    @keyframes bounce{0%,80%,100%{transform:scale(.6)}40%{transform:scale(1)}}
    #aimWrap{inset:auto 1.5rem 6.5rem auto}
    #chatBody{overscroll-behavior:contain}
    @supports(padding:max(0px)){#aimWrap{margin-bottom:max(env(safe-area-inset-bottom),1rem)}}
  </style>
</head>
<body class="bg-white">

  <!-- NAV -->
  <nav class="fixed w-full top-0 z-40 bg-white/90 backdrop-blur shadow">
    <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <span class="text-2xl font-extrabold text-maroon">🎯 AIMERS</span>
        <span class="text-xs text-gray-500 hidden sm:inline">Always Ahead — Chill • Study • Win</span>
      </div>
      <div class="hidden md:flex items-center gap-5">
        <a href="#home" class="text-maroon font-semibold">Home</a>
        <a href="#courses" class="text-gray-700 hover:text-maroon">Courses</a>
        <a href="#why" class="text-gray-700 hover:text-maroon">Why AIMERS?</a>
        <a href="#contact" class="text-gray-700 hover:text-maroon">Contact</a>
        <a href="/dashboard" class="bg-maroon text-white px-4 py-2 rounded-full font-semibold">Open Portal 👩‍💻🔥</a>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <section id="home" class="gradient-bg min-h-[88vh] flex items-center pt-20">
    <div class="max-w-6xl mx-auto px-4 py-14 text-center">
      <h1 class="text-4xl md:text-6xl font-black text-white mb-2">🎯 AIMERS</h1>
      <p class="text-xl md:text-2xl text-white/95 font-semibold mb-4">Always Ahead! — Chill + Study + Win 😎🏆</p>
      <p class="text-white/90 max-w-2xl mx-auto mb-6">Clear concepts, smart hacks, daily targets — aur tension kam, marks zyada. 🔥</p>
      <div class="flex flex-col sm:flex-row gap-3 justify-center">
        <a href="#courses" class="bg-white text-maroon px-6 py-3 rounded-full font-bold hover:opacity-95">Start Now 🚀</a>
        <a href="/dashboard" class="inline-flex items-center justify-center border-2 border-white text-white px-6 py-3 rounded-full font-semibold">Student Portal — Mark Attendance 👇</a>
      </div>
    </div>
  </section>

  <!-- COURSES -->
  <section id="courses" class="py-14 bg-gray-50">
    <div class="max-w-6xl mx-auto px-4">
      <div class="text-center mb-10">
        <h2 class="text-3xl font-bold text-maroon">Courses — Chill, Learn, Win</h2>
        <p class="text-gray-600">From basics to boards — short hacks + daily targets.</p>
      </div>
      <div class="grid md:grid-cols-4 gap-4">
        <div class="bg-maroon text-white rounded-2xl p-5 card-hover text-center float-in"><div class="text-2xl mb-2">📖</div><h3 class="font-bold">Classes 5–8</h3><p class="opacity-90 text-sm">Basics strong banado 💪</p></div>
        <div class="bg-maroon-light text-white rounded-2xl p-5 card-hover text-center float-in" style="animation-delay:.07s"><div class="text-2xl mb-2">🔬</div><h3 class="font-bold">Classes 9–10</h3><p class="opacity-90 text-sm">Boards? Chill, we got you 😌✍️</p></div>
        <div class="bg-maroon text-white rounded-2xl p-5 card-hover text-center float-in" style="animation-delay:.14s"><div class="text-2xl mb-2">🧮</div><h3 class="font-bold">Class 11</h3><p class="opacity-90 text-sm">Stream-wise specialization</p></div>
        <div class="bg-maroon-dark text-white rounded-2xl p-5 card-hover text-center float-in" style="animation-delay:.21s"><div class="text-2xl mb-2">🎓</div><h3 class="font-bold">Class 12</h3><p class="opacity-90 text-sm">Board exam mastery</p></div>
      </div>
    </div>
  </section>

  <!-- WHY -->
  <section id="why" class="py-14 bg-white">
    <div class="max-w-6xl mx-auto px-4">
      <div class="text-center mb-8">
        <h2 class="text-3xl font-bold text-maroon">Why AIMERS? — Short & Real</h2>
      </div>
      <div class="grid md:grid-cols-3 gap-4">
        <div class="flex items-start gap-3"><div class="bg-maroon rounded-full p-3 text-white">⚡</div><div><h4 class="font-semibold text-maroon">Fast Learning</h4><p class="text-gray-600 text-sm">Concepts jaldi fit baithenge 🧠✨</p></div></div>
        <div class="flex items-start gap-3"><div class="bg-maroon rounded-full p-3 text-white">🎯</div><div><h4 class="font-semibold text-maroon">Daily Targets</h4><p class="text-gray-600 text-sm">No excuses — short doable tasks 💯</p></div></div>
        <div class="flex items-start gap-3"><div class="bg-maroon rounded-full p-3 text-white">📌</div><div><h4 class="font-semibold text-maroon">Progress Track</h4><p class="text-gray-600 text-sm">Attendance, assignments & CSV exports 📊</p></div></div>
      </div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="py-14 bg-gray-50">
    <div class="max-w-6xl mx-auto px-4">
      <div class="text-center mb-8">
        <h2 class="text-2xl font-bold text-maroon">Ping Us — Quick & Simple</h2>
        <p class="text-gray-600 text-sm">Apna naam likh de yaar 🙌 — we’ll reply fast.</p>
      </div>
      <div class="grid md:grid-cols-2 gap-6">
        <form id="contactForm" class="space-y-3">
          <input id="name" required placeholder="Name" class="w-full px-4 py-3 border rounded-lg focus:border-maroon" />
          <input id="email" type="email" required placeholder="Email" class="w-full px-4 py-3 border rounded-lg focus:border-maroon" />
          <input id="phone" required placeholder="Phone number" class="w-full px-4 py-3 border rounded-lg focus:border-maroon" />
          <select id="classSel" required class="w-full px-4 py-3 border rounded-lg focus:border-maroon">
            <option value="">Select class</option><option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option><option>11</option><option>12</option>
          </select>
          <textarea id="message" rows="3" placeholder="Your message…" class="w-full px-4 py-3 border rounded-lg focus:border-maroon"></textarea>
          <button type="submit" class="w-full bg-maroon text-white py-3 rounded-full font-bold">Ping AIMERS 📩</button>
        </form>
        <div class="space-y-4">
          <div class="bg-white p-5 rounded-xl aim-shadow">
            <h4 class="font-semibold text-maroon">Contact</h4>
            <p class="text-sm text-gray-600">+91 98765 43210</p>
            <p class="text-sm text-gray-600">info@aimers.edu</p>
          </div>
          <a href="https://wa.me/919876543210?text=Hi%20AIMERS%2C%20I%20want%20admission%20info%20%F0%9F%98%8E" target="_blank" class="inline-flex items-center justify-center bg-green-500 text-white px-4 py-3 rounded-full font-semibold">Ping on WhatsApp 📲</a>
        </div>
      </div>
    </div>
  </section>

  <!-- FLOATING AIM-MITR BUTTON -->
  <button id="aimBtn" class="fixed bottom-6 right-6 z-50 w-14 h-14 rounded-full bg-maroon text-white grid place-items-center aim-shadow hover:scale-105 transition" aria-label="Open AIM-Mitr">
    🧞‍♂️
  </button>

  <!-- CHAT WIDGET -->
  <div id="aimWrap" class="hidden fixed bottom-24 right-6 z-50 w-[92vw] max-w-md bg-white rounded-2xl aim-shadow overflow-hidden">
    <div class="flex items-center justify-between bg-gray-100 px-4 py-3">
      <div class="flex items-center gap-3">
        <div class="w-9 h-9 rounded-full bg-maroon/10 grid place-items-center text-2xl">🧞‍♂️</div>
        <div>
          <div class="font-bold text-maroon">AIM-Mitr</div>
          <div class="text-xs text-gray-500">your all-time doubt buddy</div>
        </div>
      </div>
      <button id="closeChat" class="text-gray-400 hover:text-gray-600 text-xl" aria-label="Close">×</button>
    </div>

    <div id="chatBody" class="h-[56vh] overflow-y-auto p-4 space-y-3 bg-white">
      <div class="bg-gray-50 rounded-xl p-3 text-sm text-gray-700">
        Hi! Main <span class="font-semibold text-maroon">AIM-Mitr</span> 🧞‍♂️. Class & subject choose karo, phir apna doubt type karo.
      </div>
    </div>

    <div class="border-t bg-white p-3 space-y-2">
      <!-- dynamic chips -->
      <div id="chips" class="flex gap-2 overflow-x-auto pb-1"></div>

      <!-- controls -->
      <div class="flex gap-2 items-stretch">
        <select id="cls" class="w-24 px-3 py-2 border rounded-lg text-sm" aria-label="Class">
          <option value="">Class</option>
          <option>5</option><option>6</option><option>7</option><option>8</option><option>9</option><option>10</option>
          <option>11</option><option>12</option>
        </select>

        <select id="subj" class="w-40 px-3 py-2 border rounded-lg text-sm" aria-label="Subject" disabled>
          <option value="">Subject</option>
        </select>

        <div class="flex-1 flex items-stretch gap-2">
          <input id="q" class="flex-1 px-3 py-2 border rounded-lg text-sm"
                 placeholder="Class & subject select karo…" disabled />
          <!-- Toggle enter behavior -->
          <button id="enterMode"
                  class="px-3 py-2 border rounded-lg text-sm text-gray-700"
                  title="Toggle Enter behavior">↵=Send</button>
          <!-- Send button -->
          <button id="send"
                  class="px-4 py-2 bg-maroon text-white rounded-lg font-semibold opacity-50 cursor-not-allowed"
                  disabled aria-label="Send">
            ✈️
          </button>
        </div>
      </div>
      <p class="text-[11px] text-gray-500">Tips: concise doubt likho; class/subject set karo for better answer.</p>
    </div>
  </div>

  <footer class="py-6 text-center text-sm text-gray-500">© <span id="yr"></span> AIMERS • Chill + Study + Win</footer>

  <script>
    const $ = s => document.querySelector(s);
    const addMsg = (html, mine=false) => {
      const wrap = document.createElement('div');
      wrap.className = (mine ? 'bg-maroon text-white' : 'bg-gray-50 text-gray-800') + ' rounded-2xl px-4 py-3 text-sm float-in';
      wrap.innerHTML = html;
      $('#chatBody').appendChild(wrap);
      $('#chatBody').scrollTop = $('#chatBody').scrollHeight;
    };
    $('#aimBtn').onclick = ()=> $('#aimWrap').classList.toggle('hidden');
    $('#closeChat').onclick = ()=> $('#aimWrap').classList.add('hidden');
    $('#yr').textContent = new Date().getFullYear();

    // ---------- Class/Subject logic + suggestions ----------
    const SUGGESTIONS = {
      "5-10": {
        "Maths": ["What is HCF & LCM?", "Area of triangle", "Linear equations tip"],
        "Science": ["Define photosynthesis", "States of matter", "Acid vs base"]
      },
      "11-12": {
        "Maths": ["Limit of x→0 (sinx)/x", "Derivative of x^n", "Integration basics"],
        "Physics": ["Ohm’s law concept", "Scalar vs vector", "Projectile range"],
        "Chemistry": ["Define valency", "pH concept", "Hybridization (sp, sp2, sp3)"],
        "Biology": ["Mitosis vs meiosis", "Respiration vs breathing", "Genetics: allele"],
        "Accounts": ["Journal vs ledger", "Trial balance errors", "Depreciation methods"]
      }
    };
    const clsEl = $('#cls'), subjEl = $('#subj'), qEl = $('#q'),
          chipsWrap = $('#chips'), sendBtn = $('#send');
    function setDisabled(state){
      qEl.disabled = state; sendBtn.disabled = state;
      sendBtn.classList.toggle('opacity-50', state);
      sendBtn.classList.toggle('cursor-not-allowed', state);
    }
    function getBand(c){ const n = +c||0; return (n>=5&&n<=10) ? "5-10" : (n===11||n===12) ? "11-12" : null; }
    function populateSubjects(){
      subjEl.innerHTML = '<option value="">Subject</option>';
      const band = getBand(clsEl.value);
      if (!band){ subjEl.disabled=true; setDisabled(true); chipsWrap.innerHTML=''; qEl.placeholder='Class & subject select karo…'; return; }
      const subjects = Object.keys(SUGGESTIONS[band]);
      subjects.forEach(s=>{ const o=document.createElement('option'); o.value=s; o.textContent=s; subjEl.appendChild(o); });
      subjEl.disabled=false; qEl.placeholder='Subject choose karo…'; chipsWrap.innerHTML=''; setDisabled(true);
    }
    function populateChips(){
      const band = getBand(clsEl.value), subj = subjEl.value;
      chipsWrap.innerHTML=''; if (!band||!subj){ setDisabled(true); return; }
      (SUGGESTIONS[band][subj]||[]).forEach(txt=>{
        const b=document.createElement('button');
        b.className='px-3 py-2 bg-gray-100 rounded-full text-sm hover:bg-gray-200 whitespace-nowrap';
        b.textContent=txt; b.onclick=()=>{ qEl.value=txt; qEl.focus(); };
        chipsWrap.appendChild(b);
      });
      qEl.placeholder=`Ask ${subj} doubt for Class ${clsEl.value}…`;
      setDisabled(false);
    }
    clsEl.addEventListener('change', populateSubjects);
    subjEl.addEventListener('change', populateChips);

    // ---------- Send / Enter behavior ----------
    let sendOnEnter = true;
    const enterBtn = $('#enterMode');
    function updateEnterLabel(){ enterBtn.textContent = sendOnEnter ? '↵=Send' : '↵=New line'; }
    enterBtn.onclick = ()=>{ sendOnEnter = !sendOnEnter; updateEnterLabel(); };
    updateEnterLabel();

    qEl.addEventListener('keydown', e=>{
      if (e.key === 'Enter'){
        if (!clsEl.value || !subjEl.value){ e.preventDefault(); return; }
        if (sendOnEnter){ e.preventDefault(); sendMsg(); }
      }
    });
    sendBtn.onclick = sendMsg;

    // ---------- Chat send ----------
    async function sendMsg(){
      const cls = clsEl.value.trim(), subject = subjEl.value.trim(), question = qEl.value.trim();
      if (!cls || !subject || !question) return;
      addMsg(`<span class="font-semibold">👤 You:</span> ${escapeHtml(question)}`, true);
      qEl.value = '';

      const typing = document.createElement('div');
      typing.className = 'bg-gray-50 rounded-2xl px-4 py-3 text-sm';
      typing.innerHTML = `🧞‍♂️ <span class="font-semibold text-maroon">AIM-Mitr:</span> <span class="typing-dot"></span><span class="typing-dot"></span><span class="typing-dot"></span>`;
      $('#chatBody').appendChild(typing);
      $('#chatBody').scrollTop = $('#chatBody').scrollHeight;

      try{
        const r = await fetch('/api/aim-mitr', {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({ cls, subject, question })
        });
        const data = await r.json();
        typing.remove();
        if (data?.debug) console.log('%cAIM-Mitr debug→','color:#a00', data.debug);
        const answer = data?.answer || "Thoda glitch hua 😅. Ek line me dubara likh de ya thoda simple karke pooch.";
        addMsg(`🧞‍♂️ <span class="font-semibold text-maroon">AIM-Mitr:</span> ${answer}`);
      }catch(e){
        typing.remove();
        console.log('AIM-Mitr network error:', e);
        addMsg(`🧞‍♂️ <span class="font-semibold text-maroon">AIM-Mitr:</span> Network issue lag raha hai 🔌. Thodi der baad try karo.`);
      }
    }

    function escapeHtml(str){return str.replace(/[&<>"']/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;' }[m]));}

    // init
    populateSubjects();
  </script>
</body>
</html>
